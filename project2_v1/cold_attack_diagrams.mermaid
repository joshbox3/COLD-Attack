%%{init: {'theme': 'base', 'themeVariables': { 'primaryColor': '#3b82f6', 'primaryTextColor': '#fff', 'primaryBorderColor': '#1d4ed8', 'lineColor': '#6b7280', 'secondaryColor': '#f3f4f6', 'tertiaryColor': '#dbeafe'}}}%%

%% DIAGRAM 1: COLD-Attack Pipeline Overview
graph LR
    subgraph Input
        A[ğŸ¯ Harmful Query x]
    end
    
    subgraph COLD-Attack
        B[1ï¸âƒ£ Initialize<br/>Random Logits á»¹â°]
        C[2ï¸âƒ£ Langevin Dynamics<br/>2000 iterations]
        D[3ï¸âƒ£ Decode<br/>Logits â†’ Text]
    end
    
    subgraph Output
        E[âœ… Attack Suffix y]
    end
    
    A --> B
    B --> C
    C --> D
    D --> E
    
    C -->|Update: á»¹ = á»¹ - Î·âˆ‡E + Îµ| C

---

%% DIAGRAM 2: Energy Function Components
graph TB
    subgraph Energy["E(á»¹) = Î»â‚E_att + Î»â‚‚E_flu + Î»â‚ƒE_lex"]
        E_att["ğŸ¯ E_att<br/>Attack Success<br/>Î» = 100"]
        E_flu["ğŸ“ E_flu<br/>Fluency<br/>Î» = 1"]
        E_lex["ğŸš« E_lex<br/>Lexical<br/>Î» = 100"]
    end
    
    E_att --> Total["Total Energy E"]
    E_flu --> Total
    E_lex --> Total
    
    Total --> Decision{Lower E?}
    Decision -->|Yes| Better[Better Attack]
    Decision -->|No| Worse[Keep Optimizing]

---

%% DIAGRAM 3: Langevin Dynamics Loop
sequenceDiagram
    participant Init as Initialize
    participant Loop as Optimization Loop
    participant Energy as Energy Function
    participant Decode as Decoder
    
    Init->>Loop: Random logits á»¹â°
    
    loop 2000 iterations
        Loop->>Energy: Compute E(á»¹)
        Energy->>Loop: Gradient âˆ‡E
        Loop->>Loop: á»¹ = á»¹ - Î·âˆ‡E + noise
    end
    
    Loop->>Decode: Final logits á»¹á´º
    Decode->>Decode: Convert to text
    Note over Decode: "(...educational purposes only)"

---

%% DIAGRAM 4: Attack Types Comparison
graph LR
    subgraph Suffix["Type 1: Suffix Attack"]
        S1[Query x] --> S2[+ Suffix y]
        S2 --> S3["x âŠ• y"]
    end
    
    subgraph Paraphrase["Type 2: Paraphrase"]
        P1[Query x] --> P2[Rephrase]
        P2 --> P3[New query y]
    end
    
    subgraph Position["Type 3: Position"]
        O1[Query x] --> O2[+ Bridge y]
        O2 --> O3[+ Control p]
        O3 --> O4["x âŠ• y âŠ• p"]
    end

---

%% DIAGRAM 5: Our Implementation vs Paper
graph TB
    subgraph Paper["Original Paper"]
        P1[Real Gradients via Backprop]
        P2[2000 iterations]
        P3[8 samples + GPT-4 selection]
        P4[~90% ASR]
    end
    
    subgraph Ours["Our Implementation"]
        O1[SPSA Gradient Estimation]
        O2[500-1000 iterations]
        O3[8 samples + GPT-4 selection]
        O4[Target: 80%+ ASR]
    end
    
    P1 -.->|Approximated by| O1
    P2 -.->|Reduced for time| O2
    P3 -.->|Implemented| O3

---

%% DIAGRAM 6: Noise Schedule
gantt
    title Noise Schedule During Optimization
    dateFormat X
    axisFormat %s
    
    section Ïƒ = 1.0
    Explore Widely     :0, 50
    
    section Ïƒ = 0.5
    Moderate Explore   :50, 200
    
    section Ïƒ = 0.1
    Start Refining     :200, 500
    
    section Ïƒ = 0.05
    Fine-tuning        :500, 1500
    
    section Ïƒ = 0.01
    Final Polish       :1500, 2000

---

%% DIAGRAM 7: Team Workflow
graph LR
    subgraph Josh["ğŸ‘¨â€ğŸ’» Josh"]
        J1[Run 100 instances]
        J2[Generate CSVs]
    end
    
    subgraph Jordan["ğŸ§ª Jordan"]
        JO1[Aggregate data]
        JO2[Create visualizations]
    end
    
    subgraph Ian["ğŸ“Š Ian"]
        I1[Calculate metrics]
        I2[Compare baselines]
    end
    
    subgraph Chao["ğŸ“ Chao"]
        C1[Create slides]
        C2[Write problem statement]
    end
    
    J2 --> JO1
    J2 --> I1
    JO2 --> C1
    I2 --> C1
